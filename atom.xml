<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Memos]]></title>
  <link href="http://akiko74.github.com/atom.xml" rel="self"/>
  <link href="http://akiko74.github.com/"/>
  <updated>2013-04-24T08:12:03+09:00</updated>
  <id>http://akiko74.github.com/</id>
  <author>
    <name><![CDATA[Akiko Saito]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MBA Essentials クリティカルシンキング]]></title>
    <link href="http://akiko74.github.com/blog/2013/04/11/critical-thinking-mbae/"/>
    <updated>2013-04-11T07:49:00+09:00</updated>
    <id>http://akiko74.github.com/blog/2013/04/11/critical-thinking-mbae</id>
    <content type="html"><![CDATA[<p>早稲田大学×日経のMBA Essentials ２回目はクリティカルシンキングです。</p>

<p>クリティカルシンキングはグロービスのコースに通ってる人から話を聞いていて面白い印象があったので楽しみでした。
なお、冒頭で「今日は極論が出てきます。切り取られてつぶやかれると誤解を招くのでこの講義についてつぶやきとかはしないように」とのお達しがあったため、ここでは講義に対する個人的な総論やまとめを書いていて全て文責は筆者にあるという点にご留意ください。</p>

<h1>クリティカルシンキング概念</h1>

<p>まずは、概念から。</p>

<blockquote><p>「クリティカルシンキングとは(中略)証拠、正確さ、論理、合理性、公平性にもとづいて概念化したり分析したり総合判断することを指し、議論の基礎とされる」<a href="http://ja.wikipedia.org/wiki/%E6%89%B9%E5%88%A4%E7%9A%84%E6%80%9D%E8%80%83">Wikipedia</a>より</p></blockquote>

<!-- more -->


<p>「事実と意見の分解」「先入観の排除」「想像力」といったキーワードが繰り返し出てきました。
特に、「先入観」は脳が合理的に判断を簡略化した結果のため、なかなか排除が難しい。
MBAは全体的に合理的な決断が出来るようにする訓練が多いと思いますが、中でも先入観を弱める訓練は大事とのことです。</p>

<h1>先入観からの脱却</h1>

<p>講義内ではいくつか先入観の例が上がりました。</p>

<p>質問「虹は何色？」</p>

<p>最初に質問を聞いたときは、「７色だけど実際は境目の変化があるわけだから…」とか穿って考えましたがそういうことじゃなかった(笑)</p>

<p><img src="http://akiko74.github.com/images/blog/201304/rainbow.png" title="[rainbow]" ></p>

<p>通念として刷り込まれているため、色の数が異なるという発想に至らないというわけです。<br/>
そういえば、太陽の色も日本の子供は赤で塗りますが、海外は黄色だったりしますね。これも「太陽=日の丸=赤」が普通だと考えているからかもしれません。</p>

<h1>なぜクリティカルシンキングが重要か</h1>

<p>そもそも、なぜクリティカルシンキングがMBAの一環としてフォーカスされているのか。<br/>
ビジネスでまぐれ当たりは続きません。<br/>
継続のためには、将来に対する予測精度を上げて行動を最適化することが重要になります。
不確実な未来を予測するには、「帰納と演繹」を繰り返し適用し、事実の積み上げから大胆な仮説を導いて仮説検証を行うということに尽きるのではないでしょうか。<br/>
そのためのクリティカルシンキングだと考えています。このスキルは目に見えて測れるものではなく、また学習すれば上達するという性格のものでもない、成功も確約されるものではない。それでもクリティカルシンキングのテクニックを習得することで、不確実性の高い将来に対し少しでも成功の確率を上げる一助となればと思います。</p>

<h2>「価値分配型交渉」と「価値創造型交渉」</h2>

<p>まずは交渉の話から。
ビジネスでは、物事を進める上で必ず交渉が発生します。<br/>
自分の欲しい物を獲得するために、いかに交渉して相手から引き出すか。<br/>
ゼロサムゲームという言葉があるように、従来は限りあるパイをお互いに奪い合うのがビジネスの基本でした。<br/>
この場合、自分の手の内は極力明かさないことが重要なポイントとなります。<br/>
限りある価値を分配するため、「価値分配型交渉」といいます。</p>

<p>今は、「価値交渉型分配」に加え、元のパイを大きくするということが多く行われます。<br/>
技術や情報、コンテンツといった、無から有を生み出す業界で特に多く行われているように思います。<br/>
そしてこのタイプはお互いが協力することでお互いに価値を増やせることから「価値創出型交渉」といいます。<br/>
「１＋１＝２以上 」とよく言われますね。</p>

<p>では、協力するためには何が必要になるでしょう。<br/>
「価値分配型交渉」では自分の戦略を最後まで明かさないことが勝利の決め手となるのと比較して、「価値創造型交渉」ではいかに自分のところの手持ちの駒が魅力的かを開示して相手からもよい条件を引き出すことがポイントと言われます。<br/>
開示リスクもありますが、ギブアンドテイクという言葉があるとおり、まずは自分が「ギブ」出来る物を出す判断が重要だと思います。<br/>
そして、ギブアンドテイクを成立させるためにコミュニケーションの重要性が高まっているのです。</p>

<h2>目的と手段</h2>

<p>よく、「手段を目的化しない」や「『なぜ』を５回繰り返せ」と言われます。<br/>
往々にしてトップと現場の間に指示待ち中間管理職が入ると「手段の目的化」が起こりやすいとのこと。<br/>
トップの目的を理解せずに発言を絶対として捉えて、一例を唯一の手段と認識する。何この既視感。<br/>
例えば、トップが「これからは若者にも認知度を上げないと」と思って周りに方法を聞いてイマイチな知識を仕入れ（なるほど！ソシャゲか！）、「よしソシャゲを出せ！」というよくわからない号令に対して「何で？」と聞けずに「はい！かしこまりました！」と答えるパターン、ありがちですよね。で、部長あたりが「ソシャゲ作れー！」て号令だして、現場は「は？」と思いながらも（今のサービスに関連した）アーリーリタイヤに向けたソシャゲを作ったりしてしまいます。流行る訳ありません。<br/>
例は極端ですが、実際同じことが身近でありました。被害甚大でした。<br/>
実施理由を聞いたら詰まる中間管理職は一般事務職と同じ給料でいいんじゃないか…</p>

<p>(閑話休題)</p>

<p>目的は別の目的の手段でもある。そのため、概念的なところに落ちるまで深堀することで選択の幅を広げられる、という事例でした。<br/>
ユーザに聞くのも一見よいようでNGなこともあるという話が出ました。<br/>
講義ではヘルシーマックの例でしたが、<a href="http://www.amazon.co.jp/%E4%B8%8A%E5%89%8D-%E6%B7%B3%E4%B8%80%E9%83%8E/e/B004L0LTQO/ref=ntt_athr_dp_pel_1">「読むクスリ」</a> でも全く同じことが実例で上がってました。<br/>
曰く、テーブルウェアを開発する食器メーカーが新しい食器をいくつか並べてアンケートを取ったら黒の食器が「カッコいい」「おしゃれ」「今までになく斬新」「料理の見映えがいい」と高評価。<br/>
では、と早速売り出してみたら全く売れない。<br/>
なぜか。<br/>
食器は、他のテーブルウェアとの調和が大事だったり、一枚欠けても補充できるかだったり、単品で見てるときと実際の選択基準が異なってたということです。<br/>
家庭の大半が持っている白い食器の中に一部黒い食器が入るのは違和感があったんでしょうね。<br/>
うろ覚えなので詳細は違うかもしれませんが、ユーザに聞くのではなく、行動を見ろというそんな感じのエッセイでした。<br/>
「読むクスリ」は昔の本ですが、普遍的なショートエッセイなので今でも非常に得るところは多いと思います。いつか自炊しよう。</p>

<h2>相関と因果</h2>

<p>相関関係と因果関係も、よく間違われるので冷静に分析する力が必要。<br/>
最近、<a href="http://irorio.jp/canal/20130408/53686/">「朝食を週に２日程度食べる人は、全く食べない人よりもメタボになるリスクが高い」</a> というのがニュースになりましたね。</p>

<blockquote><p>その結果、男女ともに「週2日」朝食を食べる人が、最もメタボになるリスクが高く、毎日食べる人と比較すると、男性では1.9倍、女性では4.5倍も高いことがわかった。さらに、ほとんど食べない人は、毎日食べる人とほとんどリスクは変わらなかったそうで、時々朝食を食べる位なら、“毎日食べない方がまし”と言えそう。</p></blockquote>

<p>「朝食は食べた方がいい」という既成概念や先入観に対し、「食べないほうがいい」というのを提示することでニュースバリューを出していると言えます。</p>

<p>さて。<br/>
少し考えてみます。<br/>
わざわざ「朝食を週に２回」と決めて食べるケースというのはあるでしょうか。<br/>
例えば土日だけはしっかり食べようと心がけている人とか？<br/>
そういう人は、本当は平日も食べようと思ってるけど平日は忙しくて食べられてないのでは、と推測されます。<br/>
あるいは、毎日食べようと思っているけどやはり生活が不規則で結果週２回程度しか食べられてないなど。<br/>
どちらにしても、不規則もしくは多忙な日々を送っていることが想像できるように思います。<br/>
一方で、「朝食を全く食べない」「朝食を毎日食べる」という人は、実はどちらもある程度規則的な生活を送っている人ではないでしょうか。<br/>
でもこれを「『生活が不規則な人』は『生活が規則的な人』よりもメタボ率が高い」としてしまうと全く面白くない結果です。<br/>
『時々朝食を食べるくらいなら?』と書かれていますが、むしろ時々しか食べられない生活サイクルを見直すべきでしょう。<br/>
このニュースはもしかして因果と相関を混同して伝えてるのでは？と穿った見方をしてみるのもクリティカルシンキングというわけです。</p>

<p>似たようなケースで、雑に物事を考えると一見正しそうな主張が実は論理的に間違っていることは多々あります。口頭だとつい聞き流してしまうことも多いかもしれません。<br/>
これは講義内で出ていた例ですが<br/>
「首都高はいつも混んでいて全然進まない。それなのに高い料金を取るなんてけしからん。値下げするべきだ」<br/>
という投書があったとしましょう。<br/>
一見、「お金を払っているのに機能を果たせないなら値下げしろ」という主張に聞こえなくもないのですが、筋道だてて考えると<br/>
「首都高が混む」←「客がたくさん使ってるから」←「安くするともっと混むけど？？」<br/>
という結論にすぐに辿り着くと思います。<br/>
この場合、「首都高はいつも混んでいて全然進まない。こんな安い料金にするからだ。値上げするべきだ」というのが論理的な主張になります。</p>

<h2>事実と意見、そしてコンテクスト性</h2>

<p>日本は単一民族のために非常にコンテクスト性の高い文化、いわゆる「阿吽の呼吸」というのが当たり前に受け入れられる背景があります。<br/>
『相手が納得するにはどうしたらいいか？』という議論、良くありますよね。コンテクスト性の高い社会では、「説得」より「納得」のほうが重要度が上がるという興味深い話もありました。<br/>
コンテクスト性の低い社会では、相手を説得すれば物事が進むため、いかにロジカルに説明するかということが主眼になるのに対し、コンテクスト性の高い社会では相手が納得すれば物事が進むため、中身そのものより相手への気遣いや感情、背景を考慮した話をするという訳です。<br/>
主体が自分から相手に移ったことが分かります。慮るというのも、コンテクスト性の高い社会を上手に表現している言葉かもしれません。<br/>
コンテクスト性の高い社会は背景を省略出来ることから、しばし事実としての背景と主観としての背景が混ざってしまう危険性があります。<br/>
自分が物事を説明するときはもちろんのこと、相手の説明から事実と主観を見分ける能力も重要です。<br/>
余談ですが、海外在住の頃、論理的なコミュニケーション能力を育成するためのものだと思いますが中学でディベートのクラスがありました。<br/>
あるテーマに対して賛成／反対にグループが別れ、ルールに則って相手（とレフェリー）を説得するのです。<br/>
事実を事実、主張を主張として伝えるところが第一フェーズ。<br/>
第二フェーズでは、お互いに相手の第一フェーズで出た意見を別の事実から崩していく、という流れです。<br/>
第一フェーズで出せなかった意見や事実は自分の論理の補足として使えないという縛りがあり、議論を集約する効果を担ってます。<br/>
チームワークなので、それぞれのフェーズ前にはチーム内での戦略策定時間があります。<br/>
刺激的な体験で非常に面白かったのですが、あまり日本では見かけないですね。<br/>
就活中に、とある企業のグループ面接がディベートだったので、よっしゃと思ってグループ内戦略議論から始めようとしたら「そういうんじゃないんで。個人個人でやってください。」と一蹴された香ばしい記憶も講義中に蘇ってきました。</p>

<h1>最後に</h1>

<p>今回は２時間の中でいろいろとテーマがあったので少し長くなりました。<br/>
先入観は中でも一番気づき難いものだと思うので意識的に穿った見方で物事を見る訓練を続けたいと思います。<br/>
次回は「IT経営戦略」です。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MBA Essentials イントロダクション]]></title>
    <link href="http://akiko74.github.com/blog/2013/04/05/introduction-mbae/"/>
    <updated>2013-04-05T08:11:00+09:00</updated>
    <id>http://akiko74.github.com/blog/2013/04/05/introduction-mbae</id>
    <content type="html"><![CDATA[<p><a href="http://bizacademy.nikkei.co.jp/special/mba2013/">早稲田大学MBA×日経Bizアカデミー プレゼンツ MBA Essentials 2013</a>というのに行き始めました。</p>

<p>　第１回目はMBAイントロダクション。内田教授です。
経歴を見るとボストンコンサルティンググループの日本代表をされてたんですね。語り口がとても面白く、２時間があっという間でした。</p>

<p>　さて。イントロダクションの題材はジャパネットたかたのTV通販におけるマーケティング戦略です。
教材となるビデオと資料を読んだあと、会場で挙手によるディスカッションが行われました。<br/>
　以下、会場で出た意見を4Pと3Cで分析しています。</p>

<!-- more -->


<h2>4Pによる分析</h2>

<p><strong>商品</strong></p>

<ul>
<li>ナショナルブランドを取り扱う</li>
<li>品揃えの絞り込み</li>
<li>セット販売</li>
<li>下取りとセットで買い替え促進</li>
</ul>


<p><strong>価格</strong>
<em>金利手数料無料でお得感、買える感を出す
</em>価格は実は普通（「高い/普通/安い」で会場の大半が普通に挙手）
*端数をつけた心理的な価格設定</p>

<p><strong>プロモーション</strong>
<em>機能ではなく使い方を説明する
</em>CMではなく番組提供の形で宣伝する</p>

<p><strong>流通</strong>
*店舗を持たず、通販のみ</p>

<h2>3Cによる分析</h2>

<p><strong>顧客（イメージ像）</strong>
<em>比較的高齢で時間がある
</em>ネットが苦手、デジタルデバイド
<em>近所に量販店がない田舎、地方の人
</em>自分で選ぶ自信のない人、初めてその商品を持つ人
*衝動買いの人</p>

<p>　顧客ではない人も合わせて議論が出ました。<br/>
　会場でも知名度は100%でしたが、実際に買ったことのある人は5%程度。ビジネスパーソンはターゲットではないだろうというのが一致した意見で、なぜなら選べない、スペックも分からない、不要なものがセットになっている、と商品特性がニーズにあっていないからと。<br/>
　「人には２種類ある。(家電とかの）カタログを頭から見る人と後ろから見る人。後ろのスペック表から見る人は明らかにターゲットと違う」という話には納得。（自分は後者のタイプ）</p>

<p><strong>競合</strong></p>

<p><em>町の電気屋
</em>詳しい身内
<em>他の衝動買いを促すテレビショッピングの会社
</em>他のネット通販
*家電量販店</p>

<p>　ここはいまいち議論が深まらなかった点だったけど、何を視点に競合を見るかという話は重要だと思いました。<br/>
　同じ家電を売ると考えると、家電量販店やAmazonなどのネット通販だし、可処分所得を考えると同時間帯に行ってる他のTV通販、衝動買いで購入率を上げる戦略に対する脅威と考えると、詳しい身内にカカクコムなどで調べられるのが上がってきます。</p>

<p><strong>自社</strong>
<em>高田社長の熱演、独特のトーク
</em>信用できそうな人柄
<em>一貫したオペレーション（コールセンタや物流、スタジオも自前）
</em>ライブ感で売り上げを伸ばす
*テレビ以外のチラシやラジオで範囲の経済性が出る。横展開。</p>

<h2>戦略ストーリー</h2>

<p>　この後、マーケティング戦略ではそれぞれを個々に見るのではなく、整合性が大事だという話に入っていきました。</p>

<p>　いわゆる町の電気屋が家庭における家電の相談役のようになっていたけれど、家電量販店の台頭や高齢化、核家族化で機能を失う。また、電化製品の機能が高度化して、町の電気屋で修理が出来るような代物ではなくなったため、付加価値が低下。衰退。</p>

<p>↓</p>

<p>もともと町の電気屋を頼りに物を買っていて家電量販店で買いにくい人たち（立地条件、知識、気後れなど）がいわゆるレイトマジョリティやラガードとして存在する。</p>

<p>↓</p>

<p>レイトマジョリティ／ラガードの人たちが初めて購入するときは、家電量販店のような「品揃え／最新高性能」は不要。選択の不自由が逆に購入障壁を下げる。</p>

<p>↓</p>

<p>ナショナルブランドを絞り込んで販売することで初めての人への安心感を醸成</p>

<p>↓</p>

<p>初めてなので周辺機器のセットが活きてくる。</p>

<p>↓</p>

<p>金利手数料負担、セット販売、期間限定などで「いつか買いたい人」を「今買いたい人」に変えて衝動買いを促す。</p>

<p>　では、なぜこのようなことが実現できたか。</p>

<p>　TV通販では、ナショナルブランドの販売は成功しない、というのが常識だったそうです。ナショナルブランドは利益率が低く、どこでも売っているので媒体費が回収できないと。その常識をひっくり返す戦略が非常に理に適ってて見事だなと思いました。</p>

<p>　ナショナルブランドは仕入れ価格も高く、販売店側で大幅な値引きは行えない。また、ブランドイメージが重要なので低価格で売られることを嫌がる。<br/>
(独禁法的にどうかなと思いますが、家電量販店でも店頭で「この価格で売るとメーカーから怒られるんですけど…」などというセールストークを使われてるので、あながち珍しくないのでしょう」<br/>
　また今も本当かどうかは分かりませんが、メーカー側も安く卸して格安で売られてブランドイメージが傷つくよりは在庫商品を処分してしまうそうです。（勿体ない…）</p>

<p>そこで。<br/>
　ジャパネットはダブついて処分したい在庫を持つメーカーから格安で仕入れて、それに周辺機器セットという形で単価を隠し、更に下取りという名目で条件付きではあるけど実質値下げをしているというのです。<br/>
　メーカーにとっては家電量販店などで型落ち単品を叩き売られるより、値崩れしていないように見せられるほうを選ぶのでしょう。実際の仕入れは通常より遥かに低いことが想像できます。そして同じように仕入れた周辺機器をセットにする。下取りも商品単価を低く見せないための方便で、それが売れるからというわけではなく普通に処分するのだと思います。
そして購入者にとってみたらハイスペック最新型など不要なので一式まとめてお得に買えて、迷う必要のないことがメリットなのです。</p>

<p>　　では、「けっして安い訳ではないよね」というのが会場の総意だったのですが、安くないのになぜ売れるのか。それは、価格にはアンカリング効果が働くからです。</p>

<p>購入者は何と比較して安いと思って買っているのか、それはAmazonでも量販店でもなく町の電気屋の価格です。</p>

<p>町の電気屋はコストパフォーマンスの悪さをアフターサービスで補ってきた経緯があります。その価格と比較すると、ジャパネットたかたの表示価格は遥かに安いと感じるのだと思います。価格戦略には、対象顧客が何と比較するかが非常に重要だといういい事例です。</p>

<p>余談ですが、ロジャーズの普及理論はあまり使われてないそうで、これからのコースでも登場しないらしいです。
確かにターゲット層を表す言葉としても会場からは出てきませんでした。自分的にはラガードがターゲットだよなと普通に思ってたのですがね。キャズムとかと合わせて業務上よく使いますが、IT業界だけなのかしら。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?t=akiko74-22&o=9&p=8&l=as1&asins=4798101524&ref=qf_sp_asin_til&fc1=000000&IS2=1&lt1=_blank&m=amazon&lc1=0000FF&bc1=000000&bg1=FFFFFF&f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<h2>リソース活用</h2>

<p>そしてリソース活用の話に移りました。</p>

<p>　通販番組は、ライブだと売り上げが全然違うそうです。なのでジャパネットたかたは自前スタジオを持っているとのこと。
高田社長が出演する番組はやはり売り上げが全然違うみたいで、それ故会社で一番貴重なリソースは高田社長の時間になります。<br/>
　従って、移動などで時間を使うよりは自前スタジオに投資をしてそこから全て番組を配信するのが理に適っているというわけです。<br/>
　希少資源の有効活用は「ザ・ゴール」でもハービーとして出てきてましたので非常によく理解できます。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?t=akiko74-22&o=9&p=8&l=as1&asins=4478420408&ref=qf_sp_asin_til&fc1=000000&IS2=1&lt1=_blank&m=amazon&lc1=0000FF&bc1=000000&bg1=FFFFFF&f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p>最後はジャパネットたかたの今後の課題です。</p>

<p>　後継者問題、メディアの変化（マスコミ４媒体からインターネットへ）、顧客層の変化（情報収集の仕方の変化）、ナショナルブランドの影響力の低下などが上がっていましたが、一番の課題は「売る商品がなくなること」みたいです。</p>

<p>「みんなが持ち始めて、でも自分だけまだ踏み切れてない」というような誰もが持つ商品が少なくなってきたら、確かにTV通販で「いまでしょ！」みたいな売り方は出来なくなりそうですね。テレビ、パソコン、デジカメ、と来て次に何を売るのか。
実際、今はナショナルブランドや家電以外にも手を出しているようです。（テレビを見ないので何を扱っているかは良く知りません）</p>

<p>戦略はストーリーである。今後はどのような展開になるのでしょうか。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?t=akiko74-22&o=9&p=8&l=as1&asins=4492532706&ref=qf_sp_asin_til&fc1=000000&IS2=1&lt1=_blank&m=amazon&lc1=0000FF&bc1=000000&bg1=FFFFFF&f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p>この本も参考になります。一度読んだけど、Kindle版が出てるので買おうかな。</p>

<p>次は「クリティカルシンキング」です。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DeviseでNested Formを作る]]></title>
    <link href="http://akiko74.github.com/blog/2013/03/07/making-nested-forms-with-devise/"/>
    <updated>2013-03-07T08:28:00+09:00</updated>
    <id>http://akiko74.github.com/blog/2013/03/07/making-nested-forms-with-devise</id>
    <content type="html"><![CDATA[<p>Deviseを利用してユーザ登録フォームなどを作るとき子要素を一緒に登録させられるようにする方法。</p>

<p>例として、UserモデルにCharacterという子テーブルがあり、UserをDeviseで登録するときにcharactersも一緒に登録したいというケースを考えます。</p>

<p>まずはUserモデルへの追記。</p>

<div><script src='https://gist.github.com/5105404.js?file=user.rb'></script>
<noscript><pre><code>class User &lt; ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable
 
  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :characters_attributes
  # attr_accessible :title, :body
 
  has_many :characters
 
  accepts_nested_attributes_for :characters
 
  def with_character
    Array.new(5) {self.characters.build}
    self
  end
end</code></pre></noscript></div>


<p>attr_accessible に子モデルを追加します。characters_attributes という書き方で子要素全てへのアクセスを許可。</p>

<p>次に、accepts_nested_attributes_for　に子モデルを追加します。</p>

<p>そして、Viewの中に追加する field_for のために、modelに子モデルのinstanceを作成します。</p>

<p>def with_character
  self.characters.build
  self
end</p>

<p>複数個登録する場合は、Array.new(5) {self.characters.build} のような感じで配列で渡しておきます。</p>

<p>次にViewのほう。</p>

<div><script src='https://gist.github.com/5105404.js?file=new.html.erb'></script>
<noscript><pre><code>&lt;h2&gt;Registration&lt;/h2&gt;
 
&lt;%= form_for([resource, resource.with_character], :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;
  &lt;%= devise_error_messages! %&gt;
 
  &lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;
  &lt;%= f.email_field :email, :autofocus =&gt; true %&gt;&lt;/div&gt;
 
  &lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;
  &lt;%= f.password_field :password %&gt;&lt;/div&gt;
 
  &lt;div&gt;&lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;
  &lt;%= f.password_field :password_confirmation %&gt;&lt;/div&gt;
 
  &lt;div&gt;&lt;%= f.fields_for :characters do |character_form| %&gt;
    &lt;%= character_form.label :char_name %&gt;
    &lt;%= character_form.text_field :char_name %&gt;
    &lt;% end %&gt;
  &lt;/div&gt;
 
  &lt;div&gt;&lt;%= f.submit &quot;Sign up&quot; %&gt;&lt;/div&gt;
&lt;% end %&gt;
 
&lt;%= render &quot;devise/shared/links&quot; %&gt;</code></pre></noscript></div>


<p>いつもNested_formsの書き方が分からなくなりますが、まずform_forのところを[配列]で定義します。
user.rbの中でdef with_character と定義していたので、userと、userの子モデルであるcharactersのインスタンスを配列に入れます。</p>

<p>子要素はf.fields_forで入れられるので、モデル名を渡し(:characters)カラムを作成します。</p>

<p>これで、子要素まで含めて一括登録が出来るはず。
DeviseのErrorでもう一度new.html.erbが呼ばれると、子要素の配列が増えるのですが、それを解消する方法は模索中…</p>
]]></content>
  </entry>
  
</feed>
